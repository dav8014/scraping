<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorador Avanzado de Empresas Sostenibles y ODS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2e7d32;
            --secondary: #4caf50;
            --accent: #8bc34a;
            --light: #e8f5e9;
            --dark: #1b5e20;
            --text: #333;
            --warning: #ff9800;
            --danger: #f44336;
            --info: #2196f3;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: #f9f9f9;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .ai-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: rgba(0,0,0,0.1);
            padding: 10px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .ods-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            padding: 20px;
            background-color: var(--light);
        }
        
        .ods-pillar {
            flex: 1;
            min-width: 300px;
            padding: 20px;
            text-align: center;
            margin: 10px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }
        
        .ods-pillar:hover {
            transform: translateY(-5px);
        }
        
        .pillar-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .exercise-section {
            padding: 30px;
        }
        
        .instructions {
            background-color: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            position: relative;
        }
        
        .instructions::before {
            content: "汳｡";
            position: absolute;
            top: -15px;
            left: 20px;
            font-size: 2rem;
            background: white;
            padding: 5px;
            border-radius: 50%;
        }
        
        .tab-container {
            margin-bottom: 30px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .company-search {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 968px) {
            .company-search {
                grid-template-columns: 1fr;
            }
        }
        
        .search-form {
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
            position: sticky;
            top: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
        }
        
        .checkbox-group {
            display: flex;
            gap: 15px;
            margin-top: 5px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background-color: var(--dark);
        }
        
        button.secondary {
            background-color: var(--info);
        }
        
        button.secondary:hover {
            background-color: #0b7dda;
        }
        
        .results {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            min-height: 200px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            background: #e0e0e0;
            color: #555;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .filter-btn.active {
            background: var(--primary);
            color: white;
        }
        
        .company-card {
            background: white;
            border-left: 5px solid var(--accent);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: transform 0.3s;
        }
        
        .company-card:hover {
            transform: translateX(5px);
        }
        
        .company-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        
        .company-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .company-actions {
            display: flex;
            gap: 5px;
        }
        
        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
            font-size: 1rem;
            padding: 5px;
        }
        
        .action-btn:hover {
            color: var(--primary);
        }
        
        .ods-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }
        
        .ods-tag {
            background: var(--secondary);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .ods-tag.environmental {
            background: var(--primary);
        }
        
        .ods-tag.social {
            background: var(--info);
        }
        
        .ods-tag.economic {
            background: var(--warning);
        }
        
        .examples {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .example-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border-top: 3px solid var(--accent);
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .example-card:hover {
            transform: translateY(-3px);
        }
        
        .ai-analysis {
            background: #f3e5f5;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .ai-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .ai-icon {
            font-size: 1.5rem;
            color: #9c27b0;
        }
        
        .reflection {
            margin-top: 30px;
            padding: 20px;
            background: #fff3e0;
            border-radius: 10px;
        }
        
        .export-options {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: var(--dark);
            color: white;
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #777;
        }
        
        .progress-bar {
            height: 5px;
            background: #e0e0e0;
            border-radius: 5px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.5s;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="ai-badge">
                <i class="fas fa-robot"></i> Asistente IA integrado
            </div>
            <h1 id="Sostenible">Explorador Avanzado de Empresas Scraping</h1>
            <p class="subtitle">Identifica y analiza empresas que contribuyen a los Objetivos de Desarrollo Sostenible (ODS)</p>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalCompanies">0</div>
                    <div>Empresas registradas</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="environmentalCompanies">0</div>
                    <div>ﾃ［bito ambiental</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="socialCompanies">0</div>
                    <div>ﾃ［bito social</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="economicCompanies">0</div>
                    <div>ﾃ［bito econﾃｳmico</div>
                </div>
            </div>
        </header>
        
        <section class="ods-info">
            <div class="ods-pillar">
                <div class="pillar-icon">沍</div>
                <h3>ﾃ［bito Ambiental</h3>
                <p>Empresas que protegen el planeta: energﾃｭas renovables, conservaciﾃｳn de ecosistemas, economﾃｭa circular...</p>
                <div class="progress-bar">
                    <div class="progress" id="environmentalProgress"></div>
                </div>
            </div>
            <div class="ods-pillar">
                <div class="pillar-icon">汨･</div>
                <h3>ﾃ［bito Social</h3>
                <p>Empresas que promueven igualdad, educaciﾃｳn, salud y bienestar para todas las personas.</p>
                <div class="progress-bar">
                    <div class="progress" id="socialProgress"></div>
                </div>
            </div>
            <div class="ods-pillar">
                <div class="pillar-icon">汳ｼ</div>
                <h3>ﾃ［bito Econﾃｳmico</h3>
                <p>Empresas que fomentan crecimiento inclusivo, trabajo digno e innovaciﾃｳn sostenible.</p>
                <div class="progress-bar">
                    <div class="progress" id="economicProgress"></div>
                </div>
            </div>
        </section>
        
        <section class="exercise-section">
            <div class="instructions">
                <h2><i class="fas fa-tasks"></i> Instrucciones del Ejercicio</h2>
                <p>Tu misiﾃｳn es investigar y documentar empresas que contribuyan activamente a los ODS en los tres ﾃ｡mbitos. El asistente IA te ayudarﾃ｡ a analizar tus hallazgos.</p>
                <p>Busca empresas innovadoras como <strong>criaderos de corales</strong>, <strong>productoras de bioplﾃ｡sticos</strong>, <strong>empresas de energﾃｭa renovable</strong> o <strong>compaﾃｱﾃｭas con modelos de negocio inclusivos</strong>.</p>
            </div>
            
            <div class="tab-container">
                <div class="tabs">
                    <div class="tab active" data-tab="register">Registrar Empresa</div>
                    <div class="tab" data-tab="examples">Ejemplos</div>
                    <div class="tab" data-tab="analysis">Anﾃ｡lisis IA</div>
                </div>
                
                <div class="tab-content active" id="register-tab">
                    <div class="company-search">
                        <div class="search-form">
                            <h3><i class="fas fa-plus-circle"></i> Registrar una empresa sostenible</h3>
                            <form id="companyForm">
                                <div class="form-group">
                                    <label for="companyName">Nombre de la empresa:</label>
                                    <input type="text" id="companyName" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="companySector">Sector de actividad:</label>
                                    <select id="companySector" required>
                                        <option value="">Selecciona un sector</option>
                                        <option value="energia">Energﾃｭas renovables</option>
                                        <option value="conservacion">Conservaciﾃｳn ambiental</option>
                                        <option value="tecnologia">Tecnologﾃｭa sostenible</option>
                                        <option value="alimentacion">Alimentaciﾃｳn sostenible</option>
                                        <option value="moda">Moda ﾃｩtica</option>
                                        <option value="finanzas">Finanzas sostenibles</option>
                                        <option value="construccion">Construcciﾃｳn sostenible</option>
                                        <option value="movilidad">Movilidad sostenible</option>
                                        <option value="otros">Otros</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="companyDescription">Descripciﾃｳn de la actividad sostenible:</label>
                                    <textarea id="companyDescription" rows="3" required></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label>ﾃ［bitos ODS que aborda:</label>
                                    <div class="checkbox-group">
                                        <div class="checkbox-item">
                                            <input type="checkbox" id="environmental" value="ambiental">
                                            <label for="environmental">Ambiental</label>
                                        </div>
                                        <div class="checkbox-item">
                                            <input type="checkbox" id="social" value="social">
                                            <label for="social">Social</label>
                                        </div>
                                        <div class="checkbox-item">
                                            <input type="checkbox" id="economic" value="econﾃｳmico">
                                            <label for="economic">Econﾃｳmico</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="specificODS">ODS especﾃｭficos que contribuye (ej: ODS 13 - Acciﾃｳn por el clima):</label>
                                    <input type="text" id="specificODS" placeholder="ODS 7, ODS 12, ODS 14...">
                                </div>
                                
                                <div class="form-group">
                                    <label for="companyImpact">Impacto positivo generado:</label>
                                    <textarea id="companyImpact" rows="3" required></textarea>
                                </div>
                                
                                <button type="submit"><i class="fas fa-save"></i> Agregar empresa</button>
                            </form>
                        </div>
                        
                        <div class="results">
                            <div class="results-header">
                                <h3><i class="fas fa-list"></i> Empresas registradas</h3>
                                <div>
                                    <button class="secondary" onclick="exportData('json')"><i class="fas fa-download"></i> Exportar</button>
                                </div>
                            </div>
                            
                            <div class="filters">
                                <button class="filter-btn active" data-filter="all">Todas</button>
                                <button class="filter-btn" data-filter="environmental">Ambiental</button>
                                <button class="filter-btn" data-filter="social">Social</button>
                                <button class="filter-btn" data-filter="economic">Econﾃｳmico</button>
                            </div>
                            
                            <div id="companiesList">
                                <p class="no-results">Aﾃｺn no has registrado ninguna empresa. ﾂ｡Comienza a buscar!<br><br>
                                <i class="fas fa-lightbulb" style="font-size: 2rem; color: #ffc107;"></i></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="examples-tab">
                    <h3><i class="fas fa-star"></i> Ejemplos de Empresas Sostenibles</h3>
                    <p>Haz clic en cualquier ejemplo para cargarlo en el formulario:</p>
                    
                    <div class="examples">
                        <div class="example-card" onclick="fillExample('coral')">
                            <h4>Coral Vita</h4>
                            <p>Cultivo de corales para restaurar arrecifes degradados</p>
                            <p><small>ODS 14: Vida submarina</small></p>
                        </div>
                        <div class="example-card" onclick="fillExample('bioplastic')">
                            <h4>Biofase</h4>
                            <p>Bioplﾃ｡sticos a partir de semillas de aguacate</p>
                            <p><small>ODS 9, 12</small></p>
                        </div>
                        <div class="example-card" onclick="fillExample('energy')">
                            <h4>ﾃ腕sted</h4>
                            <p>Transiciﾃｳn de petrolera a energﾃｭa eﾃｳlica marina</p>
                            <p><small>ODS 7, 13</small></p>
                        </div>
                        <div class="example-card" onclick="fillExample('social')">
                            <h4>Patagonia</h4>
                            <p>Moda sostenible y activismo ambiental</p>
                            <p><small>ODS 8, 12, 13</small></p>
                        </div>
                        <div class="example-card" onclick="fillExample('vegan')">
                            <h4>Beyond Meat</h4>
                            <p>Alternativas vegetales a la carne</p>
                            <p><small>ODS 2, 12, 13</small></p>
                        </div>
                        <div class="example-card" onclick="fillExample('circular')">
                            <h4>Terracycle</h4>
                            <p>Economﾃｭa circular y reciclaje innovador</p>
                            <p><small>ODS 11, 12</small></p>
                        </div>
                        <div class="example-card" onclick="fillExample('water')">
                            <h4>Water.org</h4>
                            <p>Acceso a agua potable y saneamiento</p>
                            <p><small>ODS 6, 1</small></p>
                        </div>
                        <div class="example-card" onclick="fillExample('finance')">
                            <h4>Triodos Bank</h4>
                            <p>Banca ﾃｩtica y finanzas sostenibles</p>
                            <p><small>ODS 8, 10</small></p>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="analysis-tab">
                    <div class="ai-analysis">
                        <div class="ai-header">
                            <i class="fas fa-robot ai-icon"></i>
                            <h3>Anﾃ｡lisis de Sostenibilidad por IA</h3>
                        </div>
                        <p>Esta herramienta analiza automﾃ｡ticamente las empresas que has registrado y genera insights sobre patrones de sostenibilidad.</p>
                        
                        <div class="form-group">
                            <label for="analysisFocus">Enfoque del anﾃ｡lisis:</label>
                            <select id="analysisFocus">
                                <option value="general">Anﾃ｡lisis general</option>
                                <option value="sectors">Anﾃ｡lisis por sectores</option>
                                <option value="impact">Anﾃ｡lisis de impacto</option>
                                <option value="trends">Tendencias emergentes</option>
                            </select>
                        </div>
                        
                        <button onclick="generateAnalysis()"><i class="fas fa-chart-line"></i> Generar Anﾃ｡lisis</button>
                        
                        <div id="analysisResults" style="margin-top: 20px; padding: 15px; background: white; border-radius: 5px; display: none;">
                            <!-- Los resultados del anﾃ｡lisis se mostrarﾃ｡n aquﾃｭ -->
                        </div>
                    </div>
                    
                    <div class="reflection">
                        <h3><i class="fas fa-brain"></i> Reflexiﾃｳn</h3>
                        <p>Despuﾃｩs de investigar varias empresas, responde:</p>
                        <ol>
                            <li>ﾂｿQuﾃｩ patrﾃｳn observas en cﾃｳmo las empresas abordan la sostenibilidad?</li>
                            <li>ﾂｿCuﾃ｡l de los tres ﾃ｡mbitos (ambiental, social, econﾃｳmico) crees que recibe mﾃ｡s atenciﾃｳn?</li>
                            <li>ﾂｿQuﾃｩ tipo de innovaciﾃｳn te parece mﾃ｡s prometedora para el futuro?</li>
                            <li>ﾂｿCﾃｳmo podrﾃｭan las empresas mejorar su impacto en los ODS menos abordados?</li>
                        </ol>
                        <textarea id="reflectionText" rows="5" placeholder="Escribe tu reflexiﾃｳn aquﾃｭ..." style="width: 100%; margin-top: 10px;"></textarea>
                        
                        <div class="export-options">
                            <button onclick="saveReflection()"><i class="fas fa-save"></i> Guardar reflexiﾃｳn</button>
                            <button class="secondary" onclick="exportData('pdf')"><i class="fas fa-file-pdf"></i> Exportar a PDF</button>
                            <button class="secondary" onclick="exportData('html')"><i class="fas fa-code"></i> Exportar a HTML</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <footer>
            <p>Ejercicio de Sostenibilidad y ODS con IA &copy; 2023</p>
        </footer>
    </div>

    <script>
        // Array para almacenar las empresas registradas
        let companies = [];
        let currentFilter = 'all';
        
        // Cargar datos guardados al iniciar
        document.addEventListener('DOMContentLoaded', function() {
            initializeTabs();
            initializeFilters();
            
            const savedCompanies = localStorage.getItem('sustainableCompanies');
            const savedReflection = localStorage.getItem('sustainabilityReflection');
            
            if (savedCompanies) {
                companies = JSON.parse(savedCompanies);
                updateCompaniesList();
                updateStats();
            }
            
            if (savedReflection) {
                document.getElementById('reflectionText').value = savedReflection;
            }
        });
        
        // Sistema de pestaﾃｱas
        function initializeTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remover clase active de todas las pestaﾃｱas
                    tabs.forEach(t => t.classList.remove('active'));
                    // Aﾃｱadir clase active a la pestaﾃｱa clickeada
                    this.classList.add('active');
                    
                    // Ocultar todos los contenidos
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Mostrar el contenido correspondiente
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }
        
        // Sistema de filtros
        function initializeFilters() {
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remover clase active de todos los filtros
                    filterBtns.forEach(b => b.classList.remove('active'));
                    // Aﾃｱadir clase active al filtro clickeado
                    this.classList.add('active');
                    
                    currentFilter = this.getAttribute('data-filter');
                    updateCompaniesList();
                });
            });
        }
        
        // Manejar el envﾃｭo del formulario
        document.getElementById('companyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Obtener valores del formulario
            const name = document.getElementById('companyName').value;
            const sector = document.getElementById('companySector').value;
            const description = document.getElementById('companyDescription').value;
            const ods = document.getElementById('specificODS').value;
            const impact = document.getElementById('companyImpact').value;
            
            // Obtener ﾃ｡mbitos seleccionados
            const ambiental = document.getElementById('environmental').checked;
            const social = document.getElementById('social').checked;
            const economico = document.getElementById('economic').checked;
            
            const scopes = [];
            if (ambiental) scopes.push('environmental');
            if (social) scopes.push('social');
            if (economico) scopes.push('economic');
            
            // Validar que al menos un ﾃ｡mbito estﾃｩ seleccionado
            if (scopes.length === 0) {
                alert('Por favor, selecciona al menos un ﾃ｡mbito ODS');
                return;
            }
            
            // Crear objeto empresa
            const company = {
                id: Date.now(), // ID ﾃｺnico basado en timestamp
                name: name,
                sector: sector,
                description: description,
                ods: ods,
                impact: impact,
                scopes: scopes,
                date: new Date().toLocaleDateString('es-ES')
            };
            
            // Agregar al array y actualizar la lista
            companies.push(company);
            updateCompaniesList();
            updateStats();
            saveToLocalStorage();
            
            // Limpiar formulario
            document.getElementById('companyForm').reset();
            
            // Mostrar mensaje de ﾃｩxito
            showNotification(`Empresa "${name}" agregada correctamente`, 'success');
        });
        
        // Actualizar la lista de empresas
        function updateCompaniesList() {
            const companiesList = document.getElementById('companiesList');
            
            // Filtrar empresas segﾃｺn el filtro activo
            let filteredCompanies = companies;
            if (currentFilter !== 'all') {
                filteredCompanies = companies.filter(company => 
                    company.scopes.includes(currentFilter)
                );
            }
            
            if (filteredCompanies.length === 0) {
                companiesList.innerHTML = '<p class="no-results">No hay empresas que coincidan con el filtro seleccionado.</p>';
                return;
            }
            
            companiesList.innerHTML = '';
            
            filteredCompanies.forEach(company => {
                const companyCard = document.createElement('div');
                companyCard.className = 'company-card';
                
                companyCard.innerHTML = `
                    <div class="company-header">
                        <div>
                            <div class="company-name">${company.name}</div>
                            <div><strong>Sector:</strong> ${getSectorName(company.sector)}</div>
                        </div>
                        <div class="company-actions">
                            <button class="action-btn" onclick="editCompany(${company.id})" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="deleteCompany(${company.id})" title="Eliminar">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div><strong>Actividad:</strong> ${company.description}</div>
                    <div class="ods-tags">
                        ${company.scopes.map(scope => 
                            `<span class="ods-tag ${scope}">${getScopeName(scope)}</span>`
                        ).join('')}
                    </div>
                    <div><strong>ODS:</strong> ${company.ods}</div>
                    <div><strong>Impacto:</strong> ${company.impact}</div>
                    <div><small>Registrado el: ${company.date}</small></div>
                `;
                
                companiesList.appendChild(companyCard);
            });
        }
        
        // Actualizar estadﾃｭsticas
        function updateStats() {
            document.getElementById('totalCompanies').textContent = companies.length;
            
            const environmentalCount = companies.filter(c => c.scopes.includes('environmental')).length;
            const socialCount = companies.filter(c => c.scopes.includes('social')).length;
            const economicCount = companies.filter(c => c.scopes.includes('economic')).length;
            
            document.getElementById('environmentalCompanies').textContent = environmentalCount;
            document.getElementById('socialCompanies').textContent = socialCount;
            document.getElementById('economicCompanies').textContent = economicCount;
            
            // Actualizar barras de progreso
            const total = companies.length;
            document.getElementById('environmentalProgress').style.width = total > 0 ? (environmentalCount / total * 100) + '%' : '0%';
            document.getElementById('socialProgress').style.width = total > 0 ? (socialCount / total * 100) + '%' : '0%';
            document.getElementById('economicProgress').style.width = total > 0 ? (economicCount / total * 100) + '%' : '0%';
        }
        
        // Obtener nombre del sector
        function getSectorName(sectorKey) {
            const sectors = {
                'energia': 'Energﾃｭas renovables',
                'conservacion': 'Conservaciﾃｳn ambiental',
                'tecnologia': 'Tecnologﾃｭa sostenible',
                'alimentacion': 'Alimentaciﾃｳn sostenible',
                'moda': 'Moda ﾃｩtica',
                'finanzas': 'Finanzas sostenibles',
                'construccion': 'Construcciﾃｳn sostenible',
                'movilidad': 'Movilidad sostenible',
                'otros': 'Otros'
            };
            
            return sectors[sectorKey] || 'No especificado';
        }
        
        // Obtener nombre del ﾃ｡mbito
        function getScopeName(scopeKey) {
            const scopes = {
                'environmental': 'Ambiental',
                'social': 'Social',
                'economic': 'Econﾃｳmico'
            };
            
            return scopes[scopeKey] || scopeKey;
        }
        
        // Eliminar empresa
        function deleteCompany(id) {
            if (confirm('ﾂｿEstﾃ｡s seguro de que quieres eliminar esta empresa?')) {
                companies = companies.filter(company => company.id !== id);
                updateCompaniesList();
                updateStats();
                saveToLocalStorage();
                showNotification('Empresa eliminada correctamente', 'success');
            }
        }
        
        // Editar empresa (funciﾃｳn bﾃ｡sica)
        function editCompany(id) {
            const company = companies.find(c => c.id === id);
            if (company) {
                // Llenar el formulario con los datos de la empresa
                document.getElementById('companyName').value = company.name;
                document.getElementById('companySector').value = company.sector;
                document.getElementById('companyDescription').value = company.description;
                document.getElementById('specificODS').value = company.ods;
                document.getElementById('companyImpact').value = company.impact;
                
                document.getElementById('environmental').checked = company.scopes.includes('environmental');
                document.getElementById('social').checked = company.scopes.includes('social');
                document.getElementById('economic').checked = company.scopes.includes('economic');
                
                // Eliminar la empresa para reemplazarla despuﾃｩs de editar
                companies = companies.filter(c => c.id !== id);
                updateCompaniesList();
                updateStats();
                
                showNotification(`Editando empresa: ${company.name}`, 'info');
            }
        }
        
        // Guardar en localStorage
        function saveToLocalStorage() {
            localStorage.setItem('sustainableCompanies', JSON.stringify(companies));
        }
        
        // Guardar reflexiﾃｳn
        function saveReflection() {
            const reflection = document.getElementById('reflectionText').value;
            localStorage.setItem('sustainabilityReflection', reflection);
            showNotification('Reflexiﾃｳn guardada correctamente', 'success');
        }
        
        // Mostrar notificaciﾃｳn
        function showNotification(message, type) {
            // Crear elemento de notificaciﾃｳn
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 5px;
                color: white;
                z-index: 1000;
                font-weight: bold;
                box-shadow: 0 3px 10px rgba(0,0,0,0.2);
                animation: slideIn 0.3s ease-out;
            `;
            
            // Estilo segﾃｺn el tipo
            if (type === 'success') {
                notification.style.background = 'var(--primary)';
            } else if (type === 'error') {
                notification.style.background = 'var(--danger)';
            } else {
                notification.style.background = 'var(--info)';
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Eliminar despuﾃｩs de 3 segundos
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // Aﾃｱadir estilos de animaciﾃｳn para las notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // Ejemplos predefinidos
        function fillExample(type) {
            let companyData = {};
            
            switch(type) {
                case 'coral':
                    companyData = {
                        name: 'Coral Vita',
                        sector: 'conservacion',
                        description: 'Cultiva corales en tierra para restaurar arrecifes degradados, acelerando su crecimiento hasta 50 veces mﾃ｡s rﾃ｡pido que en la naturaleza.',
                        ods: 'ODS 14: Vida submarina',
                        impact: 'Restauraciﾃｳn de ecosistemas marinos, protecciﾃｳn de biodiversidad y mitigaciﾃｳn del impacto del cambio climﾃ｡tico en los ocﾃｩanos.',
                        scopes: ['environmental']
                    };
                    break;
                    
                case 'bioplastic':
                    companyData = {
                        name: 'Biofase',
                        sector: 'tecnologia',
                        description: 'Desarrolla bioplﾃ｡sticos a partir de semillas de aguacate que son compostables y se biodegradan en 240 dﾃｭas.',
                        ods: 'ODS 9: Industria, innovaciﾃｳn e infraestructura; ODS 12: Producciﾃｳn y consumo responsables',
                        impact: 'Reducciﾃｳn de contaminaciﾃｳn por plﾃ｡sticos, promociﾃｳn de economﾃｭa circular y uso de residuos agrﾃｭcolas como materia prima.',
                        scopes: ['environmental', 'economic']
                    };
                    break;
                    
                case 'energy':
                    companyData = {
                        name: 'ﾃ腕sted',
                        sector: 'energia',
                        description: 'Empresa danesa que transformﾃｳ su negocio de petrﾃｳleo y gas para convertirse en lﾃｭder mundial en energﾃｭa eﾃｳlica marina.',
                        ods: 'ODS 7: Energﾃｭa asequible y no contaminante; ODS 13: Acciﾃｳn por el clima',
                        impact: 'Reducciﾃｳn de emisiones de carbono, transiciﾃｳn energﾃｩtica y creaciﾃｳn de empleos verdes.',
                        scopes: ['environmental', 'economic', 'social']
                    };
                    break;
                    
                case 'social':
                    companyData = {
                        name: 'Patagonia',
                        sector: 'moda',
                        description: 'Empresa de ropa outdoor que integra sostenibilidad en su modelo de negocio, dona el 1% de sus ventas a causas ambientales y promueve la reparaciﾃｳn de prendas.',
                        ods: 'ODS 8: Trabajo decente y crecimiento econﾃｳmico; ODS 12: Producciﾃｳn y consumo responsables; ODS 13: Acciﾃｳn por el clima',
                        impact: 'Promociﾃｳn de prﾃ｡cticas laborales ﾃｩticas, reducciﾃｳn de desperdicios y activismo ambiental.',
                        scopes: ['social', 'environmental', 'economic']
                    };
                    break;
                    
                case 'vegan':
                    companyData = {
                        name: 'Beyond Meat',
                        sector: 'alimentacion',
                        description: 'Desarrolla alternativas vegetales a la carne que reducen significativamente el impacto ambiental comparado con la producciﾃｳn cﾃ｡rnica tradicional.',
                        ods: 'ODS 2: Hambre cero; ODS 12: Producciﾃｳn y consumo responsables; ODS 13: Acciﾃｳn por el clima',
                        impact: 'Reducciﾃｳn de emisiones de gases de efecto invernadero, ahorro de agua y tierra, y promociﾃｳn de alimentaciﾃｳn sostenible.',
                        scopes: ['environmental', 'social']
                    };
                    break;
                    
                case 'circular':
                    companyData = {
                        name: 'Terracycle',
                        sector: 'tecnologia',
                        description: 'Pionera en economﾃｭa circular, especializada en reciclaje de materiales difﾃｭciles de reciclar y promociﾃｳn de modelos de negocio de cero residuos.',
                        ods: 'ODS 11: Ciudades y comunidades sostenibles; ODS 12: Producciﾃｳn y consumo responsables',
                        impact: 'Desviaciﾃｳn de residuos de vertederos, innovaciﾃｳn en reciclaje y promociﾃｳn de economﾃｭa circular a escala global.',
                        scopes: ['environmental', 'economic']
                    };
                    break;
                    
                case 'water':
                    companyData = {
                        name: 'Water.org',
                        sector: 'otros',
                        description: 'Organizaciﾃｳn que facilita acceso a agua potable y saneamiento mediante soluciones financieras innovadoras en paﾃｭses en desarrollo.',
                        ods: 'ODS 6: Agua limpia y saneamiento; ODS 1: Fin de la pobreza',
                        impact: 'Millones de personas con acceso a agua segura y saneamiento, mejora de salud y oportunidades econﾃｳmicas en comunidades vulnerables.',
                        scopes: ['social', 'economic']
                    };
                    break;
                    
                case 'finance':
                    companyData = {
                        name: 'Triodos Bank',
                        sector: 'finanzas',
                        description: 'Banco ﾃｩtico que solo financia proyectos con impacto positivo en las personas, el medio ambiente y la cultura.',
                        ods: 'ODS 8: Trabajo decente y crecimiento econﾃｳmico; ODS 10: Reducciﾃｳn de las desigualdades',
                        impact: 'Financiamiento de energﾃｭas renovables, agricultura ecolﾃｳgica y proyectos sociales, con transparencia total en el uso de los fondos.',
                        scopes: ['economic', 'social', 'environmental']
                    };
                    break;
            }
            
            // Llenar el formulario con los datos del ejemplo
            document.getElementById('companyName').value = companyData.name;
            document.getElementById('companySector').value = companyData.sector;
            document.getElementById('companyDescription').value = companyData.description;
            document.getElementById('specificODS').value = companyData.ods;
            document.getElementById('companyImpact').value = companyData.impact;
            
            // Marcar los ﾃ｡mbitos correspondientes
            document.getElementById('environmental').checked = companyData.scopes.includes('environmental');
            document.getElementById('social').checked = companyData.scopes.includes('social');
            document.getElementById('economic').checked = companyData.scopes.includes('economic');
            
            // Cambiar a la pestaﾃｱa de registro
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.tab[data-tab="register"]').classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById('register-tab').classList.add('active');
            
            showNotification(`Ejemplo "${companyData.name}" cargado. Completa y guarda la informaciﾃｳn.`, 'info');
        }
        
        // Generar anﾃ｡lisis con IA simulada
        function generateAnalysis() {
            if (companies.length === 0) {
                showNotification('Primero agrega algunas empresas para poder generar un anﾃ｡lisis.', 'error');
                return;
            }
            
            const analysisFocus = document.getElementById('analysisFocus').value;
            const analysisResults = document.getElementById('analysisResults');
            
            // Simular procesamiento de IA
            analysisResults.innerHTML = '<p><i class="fas fa-spinner fa-spin"></i> Analizando datos... Esto puede tomar unos segundos.</p>';
            analysisResults.style.display = 'block';
            
            setTimeout(() => {
                let analysisText = '';
                
                // Estadﾃｭsticas bﾃ｡sicas
                const totalCompanies = companies.length;
                const environmentalCount = companies.filter(c => c.scopes.includes('environmental')).length;
                const socialCount = companies.filter(c => c.scopes.includes('social')).length;
                const economicCount = companies.filter(c => c.scopes.includes('economic')).length;
                
                // Sectores mﾃ｡s comunes
                const sectors = {};
                companies.forEach(company => {
                    sectors[company.sector] = (sectors[company.sector] || 0) + 1;
                });
                const topSector = Object.keys(sectors).reduce((a, b) => sectors[a] > sectors[b] ? a : b);
                
                // Anﾃ｡lisis segﾃｺn el enfoque seleccionado
                switch(analysisFocus) {
                    case 'general':
                        analysisText = `
                            <h4>Anﾃ｡lisis General de Sostenibilidad</h4>
                            <p>Has registrado <strong>${totalCompanies} empresas</strong> con enfoque en sostenibilidad.</p>
                            <p><strong>Distribuciﾃｳn por ﾃ｡mbito ODS:</strong></p>
                            <ul>
                                <li>Ambiental: ${environmentalCount} empresas (${Math.round(environmentalCount/totalCompanies*100)}%)</li>
                                <li>Social: ${socialCount} empresas (${Math.round(socialCount/totalCompanies*100)}%)</li>
                                <li>Econﾃｳmico: ${economicCount} empresas (${Math.round(economicCount/totalCompanies*100)}%)</li>
                            </ul>
                            <p>El sector mﾃ｡s representado es <strong>${getSectorName(topSector)}</strong>.</p>
                            <p><strong>Recomendaciﾃｳn:</strong> Considera investigar mﾃ｡s empresas del ﾃ｡mbito ${environmentalCount < socialCount && environmentalCount < economicCount ? 'ambiental' : socialCount < economicCount ? 'social' : 'econﾃｳmico'} para tener un panorama mﾃ｡s equilibrado.</p>
                        `;
                        break;
                        
                    case 'sectors':
                        analysisText = `
                            <h4>Anﾃ｡lisis por Sectores</h4>
                            <p>Distribuciﾃｳn de empresas por sector:</p>
                            <ul>
                                ${Object.entries(sectors).map(([sector, count]) => 
                                    `<li><strong>${getSectorName(sector)}</strong>: ${count} empresas (${Math.round(count/totalCompanies*100)}%)</li>`
                                ).join('')}
                            </ul>
                            <p><strong>Tendencias identificadas:</strong> Los sectores ${Object.entries(sectors).filter(([_, count]) => count >= 2).map(([sector]) => getSectorName(sector)).join(', ')} ${Object.entries(sectors).filter(([_, count]) => count >= 2).length > 1 ? 'son' : 'es'} el${Object.entries(sectors).filter(([_, count]) => count >= 2).length > 1 ? 's' : ''} mﾃ｡s representado${Object.entries(sectors).filter(([_, count]) => count >= 2).length > 1 ? 's' : ''} en tu investigaciﾃｳn.</p>
                        `;
                        break;
                        
                    case 'impact':
                        analysisText = `
                            <h4>Anﾃ｡lisis de Impacto</h4>
                            <p>Basado en las descripciones de impacto proporcionadas, se identifican los siguientes patrones:</p>
                            <ul>
                                <li><strong>Impacto ambiental:</strong> ${companies.filter(c => c.scopes.includes('environmental')).length} empresas reportan beneficios ambientales como reducciﾃｳn de emisiones, conservaciﾃｳn de recursos o protecciﾃｳn de ecosistemas.</li>
                                <li><strong>Impacto social:</strong> ${companies.filter(c => c.scopes.includes('social')).length} empresas contribuyen a mejoras en calidad de vida, educaciﾃｳn, salud o reducciﾃｳn de desigualdades.</li>
                                <li><strong>Impacto econﾃｳmico:</strong> ${companies.filter(c => c.scopes.includes('economic')).length} empresas promueven empleo digno, crecimiento inclusivo o innovaciﾃｳn sostenible.</li>
                            </ul>
                            <p><strong>Oportunidad:</strong> Las empresas con impacto en mﾃｺltiples ﾃ｡mbitos tienden a tener modelos de negocio mﾃ｡s resilientes y sostenibles a largo plazo.</p>
                        `;
                        break;
                        
                    case 'trends':
                        analysisText = `
                            <h4>Tendencias Emergentes en Sostenibilidad</h4>
                            <p>Basado en tu investigaciﾃｳn, estas son las tendencias mﾃ｡s relevantes:</p>
                            <ol>
                                <li><strong>Economﾃｭa circular:</strong> Varias empresas enfocadas en reducir residuos y maximizar el valor de los recursos.</li>
                                <li><strong>Energﾃｭas limpias:</strong> Transiciﾃｳn hacia fuentes renovables y eficiencia energﾃｩtica.</li>
                                <li><strong>Tecnologﾃｭa aplicada a sostenibilidad:</strong> Soluciones innovadoras para problemas ambientales y sociales.</li>
                                <li><strong>Consumo responsable:</strong> Empresas que promueven elecciones de consumo mﾃ｡s conscientes.</li>
                            </ol>
                            <p><strong>Predicciﾃｳn:</strong> La integraciﾃｳn de inteligencia artificial y big data en soluciones sostenibles serﾃ｡ la prﾃｳxima frontera en los prﾃｳximos aﾃｱos.</p>
                        `;
                        break;
                }
                
                analysisResults.innerHTML = analysisText;
            }, 2000);
        }
        
        // Exportar datos
        function exportData(format) {
            if (companies.length === 0) {
                showNotification('No hay datos para exportar.', 'error');
                return;
            }
            
            let dataStr, fileName, mimeType;
            
            if (format === 'json') {
                dataStr = JSON.stringify(companies, null, 2);
                fileName = 'empresas_sostenibles.json';
                mimeType = 'application/json';
            } else if (format === 'pdf') {
                // Simulaciﾃｳn de exportaciﾃｳn a PDF
                showNotification('Exportaciﾃｳn a PDF simulada. En una implementaciﾃｳn real, se generarﾃｭa un PDF con los datos.', 'info');
                return;
            } else if (format === 'html') {
                // Generar HTML con los datos
                let htmlContent = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Empresas Sostenibles - Reporte</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            h1 { color: #2e7d32; }
                            .company { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; }
                            .tags { margin: 10px 0; }
                            .tag { display: inline-block; background: #4caf50; color: white; padding: 3px 8px; border-radius: 12px; margin-right: 5px; }
                        </style>
                    </head>
                    <body>
                        <h1>Reporte de Empresas Sostenibles</h1>
                        <p>Generado el ${new Date().toLocaleDateString('es-ES')}</p>
                        <p>Total de empresas: ${companies.length}</p>
                `;
                
                companies.forEach(company => {
                    htmlContent += `
                        <div class="company">
                            <h2>${company.name}</h2>
                            <p><strong>Sector:</strong> ${getSectorName(company.sector)}</p>
                            <p><strong>Actividad:</strong> ${company.description}</p>
                            <div class="tags">
                                ${company.scopes.map(scope => `<span class="tag">${getScopeName(scope)}</span>`).join('')}
                            </div>
                            <p><strong>ODS:</strong> ${company.ods}</p>
                            <p><strong>Impacto:</strong> ${company.impact}</p>
                            <p><small>Registrado el: ${company.date}</small></p>
                        </div>
                    `;
                });
                
                htmlContent 
                
                dataStr = htmlContent;
                fileName = 'empresas_sostenibles.html';
                mimeType = 'text/html';
            }
            
            // Crear y descargar el archivo
            const blob = new Blob([dataStr], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification(`Datos exportados como ${fileName}`, 'success');
        }
    </script>
</body>
</html>